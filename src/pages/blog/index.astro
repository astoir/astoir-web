---
import Layout from "~layouts/BaseLayout.astro";
import BlogPostCard from "~components/Card/BlogPostCard";
import SeriesCard from "~components/Card/SeriesCard";
import Tag from "~components/Tag/Tag";
import { getPosts, getAllTags, getAllSeries } from "~utils/getPosts";
import FullImageBlogPostCard from "~components/Card/FullImageBlogPostCard";
import BlogPostListItem from "~components/List/BlogPostListItem";
import { FaArrowRight } from "react-icons/fa";
import TagCard from "~components/Card/TagCard";
import { FullImageSeriesCard } from "~components/Card/FullImageSeriesCard";
import { PiShootingStarFill } from "react-icons/pi";
// 태그 정보 가져오기
const tags = await getAllTags();

// 고정 포스트 가져오기
// const pinnedPosts = await getPosts({ 
//   filter: { 
//     pinned: true,
//     draft: false 
//   },
//   sort: { 
//     by: "createdAt", 
//     order: "desc" 
//   }
// });

// 일반 포스트 가져오기
const regularPosts = await getPosts({ 
  filter: { 
    draft: false 
  },
  sort: { 
    by: "createdAt", 
    order: "desc" 
  },
  paging:{
    page: 1,
    limit: 5
  }
});

// 시리즈 정보 가져오기
const series = await getAllSeries();

---
<Layout title="블로그">
  <article class="mx-auto w-full mt-16">
    {/* 인기 태그 섹션 */}
    <section class="mb-12">
      <div class="mb-8">
        <h2 class="text-2xl font-bold text-black-accent">인기 태그</h2>
        <p class="mt-1 text-black-muted">자주 다루는 주제들이에요</p>
      </div>
      
      <div class="grid grid-cols-2 gap-4 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6">
        {tags
          .sort((a, b) => b.count - a.count)
          .slice(0, 12)
          .map((tag, index) => (
            <TagCard {...tag} index={index}  client:load />
          ))}
      </div>
    </section>
   

    {/* 최근 포스트 섹션 */}
    <section class="mb-12">
      <div class="mb-8">
        <h2 class="text-2xl font-bold text-black-accent">최근 포스트</h2>
        <p class="mt-1 text-black-muted">최근 업데이트된 포스트들이에요</p>
      </div>
      
      <div class="divide-y divide-gray-100">
        {regularPosts.map((post) => (
          <BlogPostListItem 
            {...post} 
            client:load 
          />
        ))}
      </div>
    </section>

    <!-- 시리즈 섹션 -->
    <section class="mb-16">
      <div class="mb-8">
        <h2 class="text-2xl font-bold text-black-accent">시리즈</h2>
        <p class="mt-1 text-black-muted">연재 중인 시리즈들이에요</p>
      </div>

      <div class="grid auto-rows-fr gap-6 sm:grid-cols-2 lg:grid-cols-3">
        {series.slice(0, 3).map((seriesData) => (
          <FullImageSeriesCard {...seriesData} client:load />
        ))}
      </div>
    </section>

    <!-- {/* 고정된 포스트 섹션 - 모던 카드 사용 */}
    {pinnedPosts.length > 0 && (
      <section class="mb-12">
        <h2 class="mb-6 text-2xl font-bold text-black-accent">📌 주요 포스트</h2>
        <div class="grid gap-6 sm:grid-cols-2">
          {pinnedPosts.map(post => (
            <BlogPostCard {...post} client:load />
          ))}
        </div>
      </section>
    )} -->

  </article>
</Layout>

