---
import Layout from "~layouts/BaseLayout.astro";
import ProjectForm from "~components/Form/ProjectForm";
import { repositoryContainer } from "~modules/repository.module";
import { PROJECT_REPOSITORY, type ProjectRepository } from "~modules/repositories/projects/ProjectRepository";
import AdminOnly from "~components/Wrapper/AdminOnly";
import type { PostRepository } from "~modules/repositories/posts/PostRepository";
import { POST_REPOSITORY } from "~modules/repositories/posts/PostRepository";
import PostForm from "~components/Form/PostForm";

export async function getStaticPaths() {
  const postRepository = repositoryContainer.get<PostRepository>(POST_REPOSITORY);
  const posts = await postRepository.getPosts();

  const postResult = posts.items.map(post => ({
    params: { id: post.id },
    props: { post },
  }));

  return postResult;
}

const { post } = Astro.props;
---

<Layout title="포스트 수정">
  <AdminOnly client:load>
    <div class="mx-auto w-full max-w-5xl px-4 py-8 sm:px-6 lg:px-8">
      <!-- 헤더 -->
      <div class="mb-8">
        <h1 class="text-3xl font-bold text-black-accent">포스트 수정</h1>
        <p class="mt-2 text-black-muted">포스트 정보를 수정합니다</p>
      </div>
      <PostForm client:only="react" initialData={post} />
    </div>
  </AdminOnly>
</Layout>
